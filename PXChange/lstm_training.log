2025-10-31 13:55:34.403004: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-31 13:55:35.308353: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
Traceback (most recent call last):
  File "C:\Users\lukis\Documents\GitHub\Time-Series-Models\PXChange\LSTM_TF_Optimized.py", line 366, in main
    model, history, results = train_and_evaluate(dataset_id)
TypeError: cannot unpack non-iterable NoneType object
Traceback (most recent call last):
  File "C:\Users\lukis\Documents\GitHub\Time-Series-Models\PXChange\LSTM_TF_Optimized.py", line 366, in main
    model, history, results = train_and_evaluate(dataset_id)
TypeError: cannot unpack non-iterable NoneType object
2025-10-31 13:55:37.942725: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\models\functional.py:225: UserWarning: The structure of `inputs` doesn't match the expected structure: ['seq_features', 'seq_proportions', 'metadata']. Received: the structure of inputs=('*', '*', '*')
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'query' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'key' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'value' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
2025-10-31 13:55:47.386240: E tensorflow/core/util/util.cc:131] oneDNN supports DT_BOOL only on platforms with AVX-512. Falling back to the default Eigen-based implementation if present.

>> Starting Enhanced Total Time Prediction
>> Found 15 datasets: ['175651', '175974', '176133', '176196', '176401', '176886', '176887', '182625', '183257', '183305', '183407', '183597', '189701', '202073', '202513']


======================================================================
>> Processing Dataset: 175651
======================================================================
>> Error: Proportions file not found at 'C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_175651_proportions_refactored.csv'
>> Skipping 175651 due to data loading errors

>> Error processing 175651: cannot unpack non-iterable NoneType object

======================================================================
>> Processing Dataset: 175974
======================================================================
>> Error: Proportions file not found at 'C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_175974_proportions_refactored.csv'
>> Skipping 175974 due to data loading errors

>> Error processing 175974: cannot unpack non-iterable NoneType object

======================================================================
>> Processing Dataset: 176133
======================================================================
>> Prepared enhanced data for 176133: 117 sequences
   Features shape: (117, 128, 6), Proportions: (117, 128, 1), Metadata: (117, 6)

>> Building Enhanced Model...

>> Training model on 93 sequences...

Epoch 24: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.

Epoch 40: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.

Epoch 50: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.

Epoch 60: ReduceLROnPlateau reducing learning rate to 6.25000029685907e-05.
Epoch 60: early stopping
Restoring model weights from the end of the best epoch: 30.
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\models\functional.py:225: UserWarning: The structure of `inputs` doesn't match the expected structure: ['seq_features', 'seq_proportions', 'metadata']. Received: the structure of inputs=('*', '*', '*')
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'query' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'key' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'value' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
Traceback (most recent call last):
  File "C:\Users\lukis\Documents\GitHub\Time-Series-Models\PXChange\LSTM_TF_Optimized.py", line 366, in main
    model, history, results = train_and_evaluate(dataset_id)
TypeError: cannot unpack non-iterable NoneType object
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\models\functional.py:225: UserWarning: The structure of `inputs` doesn't match the expected structure: ['seq_features', 'seq_proportions', 'metadata']. Received: the structure of inputs=('*', '*', '*')
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'query' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'key' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'value' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(

>> Generating predictions...
>> Predictions saved to: C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_176133_total_time_refactored.csv
   >> MAE: 244.51s | RMSE: 347.28s | MAPE: 1839711360.00%
   >> Visualizations saved to 'visualizations\176133'

======================================================================
>> Processing Dataset: 176196
======================================================================
>> Error: Proportions file not found at 'C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_176196_proportions_refactored.csv'
>> Skipping 176196 due to data loading errors

>> Error processing 176196: cannot unpack non-iterable NoneType object

======================================================================
>> Processing Dataset: 176401
======================================================================
>> Prepared enhanced data for 176401: 217 sequences
   Features shape: (217, 128, 6), Proportions: (217, 128, 1), Metadata: (217, 6)

>> Building Enhanced Model...

>> Training model on 173 sequences...

Epoch 12: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.

Epoch 22: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.

Epoch 32: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.
Epoch 32: early stopping
Restoring model weights from the end of the best epoch: 2.
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\models\functional.py:225: UserWarning: The structure of `inputs` doesn't match the expected structure: ['seq_features', 'seq_proportions', 'metadata']. Received: the structure of inputs=('*', '*', '*')
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'query' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'key' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'value' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\models\functional.py:225: UserWarning: The structure of `inputs` doesn't match the expected structure: ['seq_features', 'seq_proportions', 'metadata']. Received: the structure of inputs=('*', '*', '*')
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'query' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'key' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'value' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(

>> Generating predictions...
>> Predictions saved to: C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_176401_total_time_refactored.csv
   >> MAE: 115.20s | RMSE: 213.20s | MAPE: 31.51%
   >> Visualizations saved to 'visualizations\176401'

======================================================================
>> Processing Dataset: 176886
======================================================================
>> Prepared enhanced data for 176886: 37 sequences
   Features shape: (37, 128, 6), Proportions: (37, 128, 1), Metadata: (37, 6)

>> Building Enhanced Model...

>> Training model on 29 sequences...

Epoch 23: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.

Epoch 69: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.

Epoch 79: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.

Epoch 89: ReduceLROnPlateau reducing learning rate to 6.25000029685907e-05.
Epoch 89: early stopping
Restoring model weights from the end of the best epoch: 59.
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\models\functional.py:225: UserWarning: The structure of `inputs` doesn't match the expected structure: ['seq_features', 'seq_proportions', 'metadata']. Received: the structure of inputs=('*', '*', '*')
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'query' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'key' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'value' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
WARNING:tensorflow:5 out of the last 12 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x0000025FAA1D2C20> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:6 out of the last 13 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x0000025FAA1D2C20> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\models\functional.py:225: UserWarning: The structure of `inputs` doesn't match the expected structure: ['seq_features', 'seq_proportions', 'metadata']. Received: the structure of inputs=('*', '*', '*')
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'query' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'key' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'value' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(

>> Generating predictions...
>> Predictions saved to: C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_176886_total_time_refactored.csv
   >> MAE: 326.91s | RMSE: 409.45s | MAPE: 221.46%
   >> Visualizations saved to 'visualizations\176886'

======================================================================
>> Processing Dataset: 176887
======================================================================
>> Prepared enhanced data for 176887: 34 sequences
   Features shape: (34, 128, 6), Proportions: (34, 128, 1), Metadata: (34, 6)

>> Building Enhanced Model...

>> Training model on 27 sequences...

Epoch 12: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.

Epoch 22: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.

Epoch 32: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.
Epoch 32: early stopping
Restoring model weights from the end of the best epoch: 2.
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\models\functional.py:225: UserWarning: The structure of `inputs` doesn't match the expected structure: ['seq_features', 'seq_proportions', 'metadata']. Received: the structure of inputs=('*', '*', '*')
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'query' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'key' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'value' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\models\functional.py:225: UserWarning: The structure of `inputs` doesn't match the expected structure: ['seq_features', 'seq_proportions', 'metadata']. Received: the structure of inputs=('*', '*', '*')
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'query' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'key' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'value' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(

>> Generating predictions...
>> Predictions saved to: C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_176887_total_time_refactored.csv
   >> MAE: 355.66s | RMSE: 418.14s | MAPE: 45.16%
   >> Visualizations saved to 'visualizations\176887'

======================================================================
>> Processing Dataset: 182625
======================================================================
>> Prepared enhanced data for 182625: 184 sequences
   Features shape: (184, 128, 6), Proportions: (184, 128, 1), Metadata: (184, 6)

>> Building Enhanced Model...

>> Training model on 147 sequences...

Epoch 13: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.

Epoch 23: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.

Epoch 38: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.

Epoch 48: ReduceLROnPlateau reducing learning rate to 6.25000029685907e-05.

Epoch 58: ReduceLROnPlateau reducing learning rate to 3.125000148429535e-05.
Epoch 58: early stopping
Restoring model weights from the end of the best epoch: 28.
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\models\functional.py:225: UserWarning: The structure of `inputs` doesn't match the expected structure: ['seq_features', 'seq_proportions', 'metadata']. Received: the structure of inputs=('*', '*', '*')
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'query' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'key' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'value' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
Traceback (most recent call last):
  File "C:\Users\lukis\Documents\GitHub\Time-Series-Models\PXChange\LSTM_TF_Optimized.py", line 366, in main
    model, history, results = train_and_evaluate(dataset_id)
TypeError: cannot unpack non-iterable NoneType object
Traceback (most recent call last):
  File "C:\Users\lukis\Documents\GitHub\Time-Series-Models\PXChange\LSTM_TF_Optimized.py", line 366, in main
    model, history, results = train_and_evaluate(dataset_id)
TypeError: cannot unpack non-iterable NoneType object
Traceback (most recent call last):
  File "C:\Users\lukis\Documents\GitHub\Time-Series-Models\PXChange\LSTM_TF_Optimized.py", line 366, in main
    model, history, results = train_and_evaluate(dataset_id)
TypeError: cannot unpack non-iterable NoneType object
Traceback (most recent call last):
  File "C:\Users\lukis\Documents\GitHub\Time-Series-Models\PXChange\LSTM_TF_Optimized.py", line 366, in main
    model, history, results = train_and_evaluate(dataset_id)
TypeError: cannot unpack non-iterable NoneType object
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\models\functional.py:225: UserWarning: The structure of `inputs` doesn't match the expected structure: ['seq_features', 'seq_proportions', 'metadata']. Received: the structure of inputs=('*', '*', '*')
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'query' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'key' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'value' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(

>> Generating predictions...
>> Predictions saved to: C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_182625_total_time_refactored.csv
   >> MAE: 151.30s | RMSE: 261.71s | MAPE: 9454791680.00%
   >> Visualizations saved to 'visualizations\182625'

======================================================================
>> Processing Dataset: 183257
======================================================================
>> Error: Proportions file not found at 'C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_183257_proportions_refactored.csv'
>> Skipping 183257 due to data loading errors

>> Error processing 183257: cannot unpack non-iterable NoneType object

======================================================================
>> Processing Dataset: 183305
======================================================================
>> Error: Proportions file not found at 'C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_183305_proportions_refactored.csv'
>> Skipping 183305 due to data loading errors

>> Error processing 183305: cannot unpack non-iterable NoneType object

======================================================================
>> Processing Dataset: 183407
======================================================================
>> Error: Proportions file not found at 'C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_183407_proportions_refactored.csv'
>> Skipping 183407 due to data loading errors

>> Error processing 183407: cannot unpack non-iterable NoneType object

======================================================================
>> Processing Dataset: 183597
======================================================================
>> Error: Proportions file not found at 'C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_183597_proportions_refactored.csv'
>> Skipping 183597 due to data loading errors

>> Error processing 183597: cannot unpack non-iterable NoneType object

======================================================================
>> Processing Dataset: 189701
======================================================================
>> Prepared enhanced data for 189701: 110 sequences
   Features shape: (110, 128, 6), Proportions: (110, 128, 1), Metadata: (110, 6)

>> Building Enhanced Model...

>> Training model on 88 sequences...

Epoch 26: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.

Epoch 36: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.

Epoch 46: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.
Epoch 46: early stopping
Restoring model weights from the end of the best epoch: 16.
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\models\functional.py:225: UserWarning: The structure of `inputs` doesn't match the expected structure: ['seq_features', 'seq_proportions', 'metadata']. Received: the structure of inputs=('*', '*', '*')
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'query' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'key' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
C:\Users\lukis\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\keras\src\layers\layer.py:932: UserWarning: Layer 'value' (of type EinsumDense) was passed an input with a mask attached to it. However, this layer does not support masking and will therefore destroy the mask information. Downstream layers will not see the mask.
  warnings.warn(
Traceback (most recent call last):
  File "C:\Users\lukis\Documents\GitHub\Time-Series-Models\PXChange\LSTM_TF_Optimized.py", line 366, in main
    model, history, results = train_and_evaluate(dataset_id)
TypeError: cannot unpack non-iterable NoneType object
Traceback (most recent call last):
  File "C:\Users\lukis\Documents\GitHub\Time-Series-Models\PXChange\LSTM_TF_Optimized.py", line 366, in main
    model, history, results = train_and_evaluate(dataset_id)
TypeError: cannot unpack non-iterable NoneType object

>> Generating predictions...
>> Predictions saved to: C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_189701_total_time_refactored.csv
   >> MAE: 121.80s | RMSE: 193.09s | MAPE: 77.06%
   >> Visualizations saved to 'visualizations\189701'

======================================================================
>> Processing Dataset: 202073
======================================================================
>> Error: Proportions file not found at 'C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_202073_proportions_refactored.csv'
>> Skipping 202073 due to data loading errors

>> Error processing 202073: cannot unpack non-iterable NoneType object

======================================================================
>> Processing Dataset: 202513
======================================================================
>> Error: Proportions file not found at 'C:/Users/lukis/Documents/GitHub/Time-Series-Models/PXChange\prediction_202513_proportions_refactored.csv'
>> Skipping 202513 due to data loading errors

>> Error processing 202513: cannot unpack non-iterable NoneType object

======================================================================
>> OVERALL SUMMARY
======================================================================
Overall MAE:  170.29 seconds
Overall RMSE: 274.90 seconds
Overall MAPE: 2796749568.00%
======================================================================

