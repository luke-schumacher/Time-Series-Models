# üß¨ SeqofSeq Dashboard

A sophisticated, modern dashboard for visualizing MRI sequence predictions generated by the SeqofSeq Pipeline. Built with Python Dash, Plotly, and Docker for seamless deployment.

![Dashboard Preview](https://img.shields.io/badge/Status-Production%20Ready-brightgreen)
![Python](https://img.shields.io/badge/Python-3.10-blue)
![Docker](https://img.shields.io/badge/Docker-Ready-2496ED)
![License](https://img.shields.io/badge/License-MIT-yellow)

## üìã Table of Contents

- [Features](#-features)
- [Architecture](#-architecture)
- [Prerequisites](#-prerequisites)
- [Quick Start](#-quick-start)
- [Usage Guide](#-usage-guide)
- [Dashboard Sections](#-dashboard-sections)
- [Configuration](#-configuration)
- [Development](#-development)
- [Troubleshooting](#-troubleshooting)
- [API Reference](#-api-reference)

## ‚ú® Features

### üìä Comprehensive Visualizations
- **Interactive Timeline**: Gantt-style visualization of sequence steps
- **Duration Analysis**: Histograms, box plots, and violin plots
- **Sequence Flow**: Sankey diagrams showing sequence transitions
- **Heatmaps**: Sequence type frequency by step position
- **Comparative Analysis**: Multi-sample comparisons

### üé® Modern UI/UX Design
- **Dark Theme**: Professional, eye-friendly dark interface
- **Responsive Layout**: Works on desktop, tablet, and mobile
- **Interactive Charts**: Hover, zoom, pan, and download capabilities
- **Real-time Updates**: Refresh data without restarting
- **Intuitive Navigation**: Tab-based organization

### üöÄ Production-Ready
- **Docker Integration**: Containerized deployment
- **Health Checks**: Automatic service monitoring
- **Volume Mounting**: Auto-sync with pipeline outputs
- **Resource Efficient**: Optimized multi-stage Docker build
- **Scalable**: Ready for production deployment

## üèóÔ∏è Architecture

```
SeqofSeq_Dashboard/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ app.py                    # Main application entry point
‚îÇ   ‚îú‚îÄ‚îÄ components/               # UI components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ overview.py          # Overview dashboard
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sequence_analysis.py # Sequence analysis tools
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ duration_analysis.py # Duration insights
‚îÇ   ‚îú‚îÄ‚îÄ utils/                   # Utility modules
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ data_loader.py       # Data loading and caching
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ visualizations.py    # Plotly chart creation
‚îÇ   ‚îî‚îÄ‚îÄ assets/
‚îÇ       ‚îî‚îÄ‚îÄ styles.css           # Custom CSS styling
‚îú‚îÄ‚îÄ data/                        # Data directory (mounted volume)
‚îú‚îÄ‚îÄ config/                      # Configuration files
‚îú‚îÄ‚îÄ Dockerfile                   # Docker image definition
‚îú‚îÄ‚îÄ docker-compose.yml          # Docker Compose configuration
‚îú‚îÄ‚îÄ requirements.txt            # Python dependencies
‚îî‚îÄ‚îÄ README.md                   # This file
```

## üì¶ Prerequisites

### Required
- **Docker**: Version 20.10 or higher
- **Docker Compose**: Version 1.29 or higher

### For Local Development
- **Python**: 3.10 or higher
- **pip**: Latest version

### Data Source
The dashboard requires data generated by the **SeqofSeq Pipeline**. Make sure you have:
1. The SeqofSeq Pipeline installed and running
2. Generated sequences output at: `../SeqofSeq_Pipeline/outputs/generated_sequences.csv`

## üöÄ Quick Start

### Method 1: Docker (Recommended)

#### Step 1: Navigate to the Dashboard Directory
```bash
cd SeqofSeq_Dashboard
```

#### Step 2: Build and Start the Dashboard
```bash
docker-compose up -d --build
```

#### Step 3: Access the Dashboard
Open your browser and navigate to:
```
http://localhost:8050
```

That's it! The dashboard should now be running and displaying your sequence data.

### Method 2: Local Development

#### Step 1: Install Dependencies
```bash
cd SeqofSeq_Dashboard
pip install -r requirements.txt
```

#### Step 2: Set Environment Variables
```bash
# Windows (PowerShell)
$env:DATA_PATH = "../SeqofSeq_Pipeline/outputs/generated_sequences.csv"
$env:PORT = "8050"
$env:DEBUG = "true"

# Linux/Mac
export DATA_PATH="../SeqofSeq_Pipeline/outputs/generated_sequences.csv"
export PORT=8050
export DEBUG=true
```

#### Step 3: Run the Application
```bash
python -m app.app
```

#### Step 4: Access the Dashboard
```
http://localhost:8050
```

## üìñ Usage Guide

### Starting the Dashboard

```bash
# Start in detached mode
docker-compose up -d

# Start with logs visible
docker-compose up

# Rebuild and start (after code changes)
docker-compose up -d --build
```

### Stopping the Dashboard

```bash
# Stop services
docker-compose down

# Stop and remove volumes
docker-compose down -v
```

### Viewing Logs

```bash
# View all logs
docker-compose logs

# Follow logs in real-time
docker-compose logs -f dashboard

# View last 100 lines
docker-compose logs --tail=100 dashboard
```

### Refreshing Data

The dashboard automatically reads from the mounted volume. To refresh data:

1. **Generate New Sequences** in the SeqofSeq Pipeline:
   ```bash
   cd ../SeqofSeq_Pipeline
   docker exec -it seqofseq_pipeline python main_pipeline.py generate
   ```

2. **Click the Refresh Button** in the dashboard header, or

3. **Restart the Dashboard**:
   ```bash
   docker-compose restart dashboard
   ```

## üéØ Dashboard Sections

### 1. Overview Tab (üìä)

**Purpose**: High-level summary of all generated sequences

**Features**:
- **Key Metrics Cards**: Total samples, sequences, patients, avg duration
- **Sequence Type Distribution**: Bar chart of most common sequences
- **Duration Distribution**: Histogram of all durations
- **Sequence Length Distribution**: Analysis of sequence lengths
- **Statistics Table**: Detailed stats for each sequence type

**Use Cases**:
- Quick health check of generated data
- Identify most common sequence types
- Understand overall duration patterns

### 2. Sequence Analysis Tab (üîç)

**Purpose**: Detailed exploration of individual sequences

**Features**:
- **Sample Selector**: Choose specific samples to analyze
- **Gantt Timeline**: Visual timeline of sequence steps
- **Cumulative Duration Plot**: Compare multiple samples
- **Sankey Diagram**: Sequence transition flow
- **Position Heatmap**: Sequence types by step position
- **Details Table**: Step-by-step breakdown

**Use Cases**:
- Analyze specific patient sequences
- Compare sequences across samples
- Identify common sequence patterns
- Understand sequence transitions

### 3. Duration Analysis Tab (‚è±Ô∏è)

**Purpose**: Deep dive into duration predictions

**Features**:
- **Duration Statistics**: Mean, median, std, min, max, total
- **Histogram**: Duration distribution
- **Box Plot**: Duration by sequence type
- **Duration Over Steps**: How duration changes by position
- **Violin Plot**: Detailed distribution visualization
- **Top Sequences Tables**: Longest and shortest durations

**Use Cases**:
- Identify outliers in duration predictions
- Compare durations across sequence types
- Understand duration variability
- Find optimization opportunities

## ‚öôÔ∏è Configuration

### Environment Variables

You can customize the dashboard behavior using environment variables:

| Variable | Default | Description |
|----------|---------|-------------|
| `DATA_PATH` | `/app/data/generated_sequences.csv` | Path to sequence data |
| `PORT` | `8050` | Dashboard port |
| `DEBUG` | `false` | Enable debug mode |
| `PYTHONUNBUFFERED` | `1` | Python output buffering |

### Modify in docker-compose.yml

```yaml
environment:
  - DATA_PATH=/app/data/generated_sequences.csv
  - PORT=8050
  - DEBUG=true  # Enable for development
```

### Custom Data Path

To use a different data source:

1. **Edit docker-compose.yml**:
   ```yaml
   volumes:
     - /path/to/your/data:/app/data:ro
   ```

2. **Update environment**:
   ```yaml
   environment:
     - DATA_PATH=/app/data/your_file.csv
   ```

3. **Restart**:
   ```bash
   docker-compose up -d --build
   ```

## üíª Development

### Local Development Setup

1. **Clone and Install**:
   ```bash
   cd SeqofSeq_Dashboard
   python -m venv venv
   source venv/bin/activate  # Windows: venv\Scripts\activate
   pip install -r requirements.txt
   ```

2. **Run in Debug Mode**:
   ```bash
   export DEBUG=true
   python -m app.app
   ```

3. **Make Changes**:
   - Edit files in `app/`
   - Dashboard auto-reloads in debug mode
   - Test changes at `http://localhost:8050`

### Adding New Visualizations

1. **Create visualization function** in `app/utils/visualizations.py`:
   ```python
   def create_my_chart(df: pd.DataFrame) -> go.Figure:
       fig = go.Figure()
       # ... add traces ...
       return apply_dark_theme(fig)
   ```

2. **Add to component** in `app/components/`:
   ```python
   dcc.Graph(
       id='my-chart',
       figure=create_my_chart(df)
   )
   ```

3. **Create callback** if needed in `app/app.py`:
   ```python
   @callback(
       Output('my-chart', 'figure'),
       Input('some-selector', 'value')
   )
   def update_my_chart(value):
       return create_my_chart(filtered_df)
   ```

### Customizing Styles

Edit `app/assets/styles.css` to customize:
- Colors (modify CSS variables in `:root`)
- Layout (grid templates, spacing)
- Component styles (cards, charts, etc.)

### Running Tests

```bash
# Install test dependencies
pip install pytest pytest-cov

# Run tests (when implemented)
pytest tests/
```

## üîß Troubleshooting

### Dashboard Shows "Data Not Available"

**Cause**: Data file not found or path incorrect

**Solutions**:
1. Verify data file exists:
   ```bash
   ls ../SeqofSeq_Pipeline/outputs/generated_sequences.csv
   ```

2. Generate data if missing:
   ```bash
   cd ../SeqofSeq_Pipeline
   docker exec -it seqofseq_pipeline python main_pipeline.py generate
   ```

3. Check volume mount in docker-compose.yml

### Port Already in Use

**Cause**: Port 8050 is occupied

**Solution**: Change port in docker-compose.yml:
```yaml
ports:
  - "8051:8050"  # Use 8051 instead
```

### Container Fails Health Check

**Cause**: Application not starting properly

**Solutions**:
1. Check logs:
   ```bash
   docker-compose logs dashboard
   ```

2. Verify data path:
   ```bash
   docker exec seqofseq_dashboard ls /app/data
   ```

3. Restart container:
   ```bash
   docker-compose restart dashboard
   ```

### Charts Not Rendering

**Cause**: JavaScript or browser compatibility

**Solutions**:
1. Clear browser cache
2. Try a different browser (Chrome recommended)
3. Check browser console for errors (F12)

### Slow Performance

**Cause**: Large dataset or resource constraints

**Solutions**:
1. Increase Docker memory limit
2. Reduce number of samples displayed
3. Add pagination to tables
4. Optimize queries in data_loader.py

## üìö API Reference

### DataLoader Class

```python
from app.utils.data_loader import DataLoader

# Initialize
loader = DataLoader('/path/to/data.csv')

# Load data
df = loader.load_data()

# Get statistics
stats = loader.get_summary_stats(df)
seq_stats = loader.get_sequence_type_stats(df)
transitions = loader.get_sequence_transitions(df)
```

### Visualization Functions

```python
from app.utils.visualizations import *

# Create charts
fig = create_sequence_timeline(df, sample_id=0)
fig = create_duration_distribution(df)
fig = create_sankey_diagram(transition_df)
fig = create_heatmap(df)
```

## ü§ù Contributing

Contributions are welcome! Please:

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Add tests if applicable
5. Submit a pull request

## üìÑ License

MIT License - See LICENSE file for details

## üôè Acknowledgments

- Built with [Dash](https://dash.plotly.com/) by Plotly
- Visualizations powered by [Plotly](https://plotly.com/)
- UI components from [Dash Bootstrap Components](https://dash-bootstrap-components.opensource.faculty.ai/)

## üìû Support

For issues, questions, or suggestions:
- Open an issue on GitHub
- Check existing documentation
- Review troubleshooting section

---

**Built with ‚ù§Ô∏è for MRI sequence analysis**

*Last Updated: 2025*
